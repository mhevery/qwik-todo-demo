/**
 * @license
 * Copyright BuilderIO All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/BuilderIO/qwik/blob/main/LICENSE
 */
import { injectMethod, markDirty, getInjector } from '../qwik.js';
import { TodoEntity } from './Todo.js';
export default injectMethod(TodoEntity, //
async function archive() {
    const items = this.$state.items;
    const element = this.$element;
    const injector = getInjector(element);
    this.$state.items = (await Promise.all(items.map((key) => injector.getEntity(key))))
        .filter((itemEntity) => {
        const completed = itemEntity.$state.completed;
        if (completed) {
            itemEntity.$release();
        }
        return !completed;
    })
        .map((itemEntity) => itemEntity.$key);
    this.$state.completed = 0;
    this.setFilter(this.$state.filter);
    markDirty(this);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVG9kb19hcmNoaXZlLmpzIiwic291cmNlUm9vdCI6Ii4vIiwic291cmNlcyI6WyJzcmMvZGF0YS9Ub2RvX2FyY2hpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztHQU1HO0FBRUgsT0FBTyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFFdkMsZUFBZSxZQUFZLENBQ3pCLFVBQVUsRUFBRSxFQUFFO0FBQ2QsS0FBSyxVQUFVLE9BQU87SUFDcEIsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7SUFDaEMsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQztJQUM5QixNQUFNLFFBQVEsR0FBRyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDdEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsQ0FBQyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDakYsTUFBTSxDQUFDLENBQUMsVUFBVSxFQUFFLEVBQUU7UUFDckIsTUFBTSxTQUFTLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUM7UUFDOUMsSUFBSSxTQUFTLEVBQUU7WUFDYixVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7U0FDdkI7UUFDRCxPQUFPLENBQUMsU0FBUyxDQUFDO0lBQ3BCLENBQUMsQ0FBQztTQUNELEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRXhDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQztJQUMxQixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDbkMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2xCLENBQUMsQ0FDRixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEJ1aWxkZXJJTyBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9CdWlsZGVySU8vcXdpay9ibG9iL21haW4vTElDRU5TRVxuICovXG5cbmltcG9ydCB7IGluamVjdE1ldGhvZCwgbWFya0RpcnR5LCBnZXRJbmplY3RvciB9IGZyb20gJy4uL3F3aWsuanMnO1xuaW1wb3J0IHsgVG9kb0VudGl0eSB9IGZyb20gJy4vVG9kby5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGluamVjdE1ldGhvZChcbiAgVG9kb0VudGl0eSwgLy9cbiAgYXN5bmMgZnVuY3Rpb24gYXJjaGl2ZSh0aGlzOiBUb2RvRW50aXR5KSB7XG4gICAgY29uc3QgaXRlbXMgPSB0aGlzLiRzdGF0ZS5pdGVtcztcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy4kZWxlbWVudDtcbiAgICBjb25zdCBpbmplY3RvciA9IGdldEluamVjdG9yKGVsZW1lbnQpO1xuICAgIHRoaXMuJHN0YXRlLml0ZW1zID0gKGF3YWl0IFByb21pc2UuYWxsKGl0ZW1zLm1hcCgoa2V5KSA9PiBpbmplY3Rvci5nZXRFbnRpdHkoa2V5KSkpKVxuICAgICAgLmZpbHRlcigoaXRlbUVudGl0eSkgPT4ge1xuICAgICAgICBjb25zdCBjb21wbGV0ZWQgPSBpdGVtRW50aXR5LiRzdGF0ZS5jb21wbGV0ZWQ7XG4gICAgICAgIGlmIChjb21wbGV0ZWQpIHtcbiAgICAgICAgICBpdGVtRW50aXR5LiRyZWxlYXNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFjb21wbGV0ZWQ7XG4gICAgICB9KVxuICAgICAgLm1hcCgoaXRlbUVudGl0eSkgPT4gaXRlbUVudGl0eS4ka2V5KTtcblxuICAgIHRoaXMuJHN0YXRlLmNvbXBsZXRlZCA9IDA7XG4gICAgdGhpcy5zZXRGaWx0ZXIodGhpcy4kc3RhdGUuZmlsdGVyKTtcbiAgICBtYXJrRGlydHkodGhpcyk7XG4gIH1cbik7XG4iXX0=